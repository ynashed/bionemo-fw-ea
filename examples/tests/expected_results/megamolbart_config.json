{
    "name": "MegaMolBART",
    "do_training": "true",
    "do_testing": "false",
    "seed": "42",
    "restore_from_path": "null",
    "trainer": {
        "devices": "1",
        "num_nodes": "1",
        "precision": "16",
        "accelerator": "gpu",
        "max_epochs": "1",
        "max_steps": "500",
        "log_every_n_steps": "100",
        "val_check_interval": "50",
        "num_sanity_val_steps": "2",
        "limit_train_batches": "1.0",
        "limit_val_batches": "1",
        "limit_test_batches": "0",
        "accumulate_grad_batches": "1",
        "gradient_clip_val": "1.0",
        "logger": "false",
        "enable_checkpointing": "false",
        "replace_sampler_ddp": "false"
    },
    "model": {
        "name": "xsmall_span_aug",
        "micro_batch_size": "4",
        "global_batch_size": "null",
        "tensor_model_parallel_size": "1",
        "pipeline_model_parallel_size": "1",
        "resume_from_checkpoint": "null",
        "pipeline_model_parallel_split_rank": "0",
        "make_vocab_size_divisible_by": "128",
        "pre_process": "true",
        "post_process": "true",
        "megatron_amp_O2": "false",
        "seq_length": "512",
        "max_position_embeddings": "512",
        "num_layers": "2",
        "hidden_size": "256",
        "ffn_hidden_size": "1024",
        "num_attention_heads": "4",
        "init_method_std": "0.02",
        "hidden_dropout": "0.1",
        "attention_dropout": "0.1",
        "position_embedding_type": "learned_absolute",
        "relative_position_bias_self_attention_only": "true",
        "relative_attention_num_buckets": "32",
        "relative_attention_max_distance": "128",
        "kv_channels": "null",
        "apply_query_key_layer_scaling": "true",
        "layernorm_epsilon": "1.0e-05",
        "persist_layer_norm": "true",
        "gradient_as_bucket_view": "true",
        "bias_gelu_fusion": "true",
        "masked_softmax_fusion": "true",
        "bias_dropout_add_fusion": "true",
        "bias": "true",
        "normalization": "layernorm",
        "encoder_arch": "transformer",
        "decoder_arch": "transformer",
        "activation": "gelu",
        "headscale": "false",
        "share_token_embeddings": "true",
        "share_decoder_tokens_head_embeddings": "false",
        "tokenizer": {
            "library": "regex",
            "type": "null",
            "model": "/tokenizers/molecule/megamolbart/vocab/megamolbart.model",
            "vocab_file": "/tokenizers/molecule/megamolbart/vocab/megamolbart.vocab",
            "merge_file": "null"
        },
        "data": {
            "links_file": "/workspace/bionemo/examples/molecule/megamolbart/dataset/ZINC-downloader.txt",
            "dataset_path": "/workspace/bionemo/examples/tests/test_data/molecule/",
            "dataset": {
                "train": "x[000..001]",
                "test": "x[000..001]",
                "val": "x[000..001]"
            },
            "encoder_augment": "true",
            "encoder_mask": "true",
            "decoder_augment": "true",
            "decoder_mask": "false",
            "mask_prob": "0.1",
            "span_lambda": "3.0",
            "micro_batch_size": "4",
            "num_workers": "10",
            "dataloader_type": "single",
            "canonicalize_input": "true",
            "max_seq_length": "512",
            "seed": "42",
            "skip_lines": "0",
            "drop_last": "false",
            "pin_memory": "false",
            "index_mapping_dir": "null",
            "data_impl": "csv_mmap",
            "data_impl_kwargs": {
                "csv_mmap": {
                    "newline_int": "10",
                    "header_lines": "1",
                    "workers": "10",
                    "sort_dataset_paths": "true",
                    "data_sep": ",",
                    "data_col": "1"
                }
            },
            "use_upsampling": "true",
            "data_col": "1",
            "data_sep": ",",
            "header_lines": "1"
        },
        "optim": {
            "name": "fused_adam",
            "lr": "1.0",
            "betas": [
                "0.9",
                "0.999"
            ],
            "eps": "1.0e-08",
            "weight_decay": "0.01",
            "sched": {
                "name": "NoamAnnealing",
                "d_model": "256",
                "warmup_steps": "8000",
                "warmup_ratio": "null",
                "max_steps": "1000000",
                "min_lr": "1.0e-05"
            }
        },
        "dwnstr_task_validation": {
            "enabled": "false",
            "dataset": {
                "class": "SingleValuePredictionCallback",
                "task_type": "regression",
                "infer_target": "bionemo.model.molecule.megamolbart.infer.MegaMolBARTInference",
                "max_seq_length": "512",
                "emb_batch_size": "32",
                "batch_size": "32",
                "num_epochs": "1",
                "shuffle": "true",
                "num_workers": "8",
                "dataset_path": "/workspace/bionemo/examples/tests/test_data/molecule/physchem/SAMPL",
                "task_name": "SAMPL",
                "dataset": {
                    "train": "x000",
                    "test": "x000",
                    "val": "x000"
                },
                "sequence_column": "smiles",
                "target_column": "expt",
                "random_seed": "1234",
                "optim": {
                    "name": "adam",
                    "lr": "0.0001",
                    "betas": [
                        "0.9",
                        "0.999"
                    ],
                    "eps": "1.0e-08",
                    "weight_decay": "0.01",
                    "sched": {
                        "name": "WarmupAnnealing",
                        "min_lr": "1.0e-05",
                        "last_epoch": "-1",
                        "warmup_ratio": "0.01",
                        "max_steps": "1000"
                    }
                }
            }
        }
    },
    "exp_manager": {
        "name": "MegaMolBART",
        "resume_if_exists": "true",
        "resume_ignore_no_checkpoint": "true",
        "create_checkpoint_callback": "true",
        "checkpoint_callback_params": {
            "save_top_k": "3",
            "monitor": "val_molecular_accuracy",
            "mode": "max",
            "save_last": "true",
            "always_save_nemo": "true",
            "filename": "MegaMolBART-xsmall_span_aug--{val_molecular_accuracy:.2f}-{val_reduced_loss:.2f}-{step}-{consumed_samples}",
            "model_parallel_size": "1"
        },
        "exp_dir": "/tmp/nemo_experiments/megamolbart_pretrain",
        "explicit_log_dir": "/tmp/nemo_experiments/megamolbart_pretrain",
        "create_wandb_logger": "false",
        "create_tensorboard_logger": "false",
        "wandb_logger_kwargs": {
            "project": "xsmall_span_aug_pretraining",
            "name": "xsmall_span_aug_pretraining",
            "group": "xsmall_span_aug",
            "job_type": "Localhost_nodes_1_gpus_1",
            "tags": [
                "MegaMolBART",
                "xsmall_span_aug"
            ],
            "offline": "true"
        }
    }
}